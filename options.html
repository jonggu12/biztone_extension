<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>BizTone 설정</title>
  <style>
    body { max-width: 720px; margin: 0 auto; padding: 24px; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', Arial; color: #0b1220; }
    .card { border:1px solid #e5e7eb; border-radius:12px; padding:16px; box-shadow: 0 4px 16px rgba(0,0,0,.03); }
    label { display:block; font-weight:700; margin-bottom:6px; }
    input, select { width:100%; padding:10px; border:1px solid #d1d5db; border-radius:8px; }
    .row { display:flex; gap:12px; margin-top:10px; }
    button { padding:10px 14px; border-radius:8px; border:1px solid #1f2937; background:#111827; color:#fff; cursor:pointer; }
    .muted { color:#6b7280; font-size: 14px; }
    .banner { 
      background: linear-gradient(135deg, #f0f9ff, #e0f2fe); 
      border: 1px solid #0ea5e9; 
      margin-bottom: 24px; 
      transition: all 0.3s ease;
      overflow: hidden;
    }
    
    .banner.hidden {
      max-height: 0;
      margin: 0;
      padding: 0;
      opacity: 0;
      transform: translateY(-20px);
    }
    .banner-content { display: flex; gap: 16px; align-items: flex-start; }
    .banner-icon { font-size: 24px; margin-top: 4px; flex-shrink: 0; }
    .banner-text { flex: 1; }
    .banner-title { font-weight: 600; color: #0369a1; margin: 0 0 8px 0; }
    .banner-desc { font-size: 14px; color: #075985; line-height: 1.5; margin: 0 0 16px 0; }
    .banner-tips { font-size: 13px; color: #0c4a6e; background: rgba(255,255,255,0.6); padding: 8px 12px; border-radius: 6px; margin: 8px 0; }
    .banner-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
    .btn-primary { background: #0ea5e9; color: white; border: 1px solid #0ea5e9; }
    .btn-secondary { background: white; color: #0369a1; border: 1px solid #0ea5e9; }
    .btn-tertiary { background: #10b981; color: white; border: 1px solid #10b981; }
    .banner-buttons button { padding: 8px 14px; font-size: 13px; font-weight: 500; }
    @media (max-width: 600px) {
      .banner-content { flex-direction: column; gap: 12px; }
      .banner-buttons { justify-content: flex-start; }
      .banner-buttons button { flex: 1; min-width: 140px; }
    }
    
    /* Features Overview Styles */
    .features-overview {
      margin-bottom: 24px;
      background: linear-gradient(135deg, #f8fafc, #f1f5f9);
      border: 1px solid #e2e8f0;
    }
    
    .features-header {
      text-align: center;
      margin-bottom: 24px;
    }
    
    .features-header h2 {
      margin: 0 0 8px 0;
      color: #1e293b;
      font-size: 24px;
    }
    
    .features-subtitle {
      margin: 0;
      color: #64748b;
      font-size: 16px;
      line-height: 1.5;
    }
    
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    
    .feature-item {
      display: flex;
      gap: 12px;
      padding: 16px;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      transition: all 0.2s ease;
    }
    
    .feature-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      border-color: #3b82f6;
    }
    
    .feature-icon {
      font-size: 24px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      border-radius: 10px;
      flex-shrink: 0;
    }
    
    .feature-content h3 {
      margin: 0 0 4px 0;
      color: #1e293b;
      font-size: 16px;
      font-weight: 600;
    }
    
    .feature-content p {
      margin: 0;
      color: #64748b;
      font-size: 14px;
      line-height: 1.5;
    }
    
    .features-shortcuts {
      background: white;
      padding: 20px;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
    }
    
    .features-shortcuts h3 {
      margin: 0 0 16px 0;
      color: #1e293b;
      font-size: 18px;
      text-align: center;
    }
    
    .shortcut-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 12px;
    }
    
    .shortcut-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: #f8fafc;
      border-radius: 8px;
      border: 1px solid #e2e8f0;
    }
    
    .shortcut-item kbd {
      background: #1e293b;
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      border: 1px solid #334155;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      min-width: 140px;
      text-align: center;
    }
    
    .shortcut-item span {
      color: #475569;
      font-size: 14px;
      flex: 1;
    }
    
    @media (max-width: 600px) {
      .features-grid {
        grid-template-columns: 1fr;
      }
      
      .shortcut-grid {
        grid-template-columns: 1fr;
      }
      
      .shortcut-item {
        flex-direction: column;
        text-align: center;
        gap: 8px;
      }
      
      .shortcut-item kbd {
        min-width: auto;
      }
    }
    
    /* List Item Styles */
    .list-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      margin: 8px 0;
      transition: all 0.2s ease;
    }
    
    .list-item:hover {
      background: #f1f5f9;
      border-color: #cbd5e1;
    }
    
    .list-item-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    
    .list-item-text {
      font-weight: 600;
      color: #1e293b;
      font-family: monospace;
      background: white;
      padding: 4px 8px;
      border-radius: 4px;
      border: 1px solid #e2e8f0;
      display: inline-block;
      max-width: fit-content;
    }
    
    .list-item-meta {
      display: flex;
      gap: 12px;
      font-size: 12px;
      color: #64748b;
    }
    
    .list-item-tag {
      background: #e2e8f0;
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .list-item-tag.match-exact { background: #dbeafe; color: #1e40af; }
    .list-item-tag.match-contains { background: #dcfce7; color: #166534; }
    .list-item-tag.match-regex { background: #fef3c7; color: #92400e; }
    
    .list-item-tag.weight-1 { background: #dcfce7; color: #166534; }
    .list-item-tag.weight-2 { background: #fef3c7; color: #92400e; }
    .list-item-tag.weight-3 { background: #fecaca; color: #dc2626; }
    .list-item-tag.weight-4 { background: #ef4444; color: white; }
    
    .list-item-tag.locale-ko { background: #e0e7ff; color: #3730a3; }
    .list-item-tag.locale-en { background: #f3e8ff; color: #6b21a8; }
    .list-item-tag.locale-all { background: #f1f5f9; color: #475569; }
    
    .list-item-actions {
      display: flex;
      gap: 8px;
    }
    
    .list-item button {
      padding: 6px 12px;
      font-size: 12px;
      background: #ef4444;
      color: white;
      border: 1px solid #dc2626;
    }
    
    .list-item button:hover {
      background: #dc2626;
      border-color: #b91c1c;
    }
    
    .list-empty {
      text-align: center;
      padding: 24px;
      color: #64748b;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h1>BizTone 설정</h1>
  
  <!-- 기능 안내 섹션 -->
  <div class="card features-overview">
    <div class="features-header">
      <h2>✨ BizTone 주요 기능</h2>
      <p class="features-subtitle">감정적인 표현을 정중한 비즈니스 문장으로 자동 변환하는 Chrome 확장 프로그램</p>
    </div>
    
    <div class="features-grid">
      <div class="feature-item">
        <div class="feature-icon">⚡</div>
        <div class="feature-content">
          <h3>실시간 감지</h3>
          <p>타이핑 중 욕설/감정적 표현을 즉시 감지하여 시각적 경고 표시</p>
        </div>
      </div>
      
      <div class="feature-item">
        <div class="feature-icon">🛡️</div>
        <div class="feature-content">
          <h3>Enter 키 가드</h3>
          <p>메시지 전송 전 최종 검증으로 위험한 내용 차단 및 변환 옵션 제공</p>
        </div>
      </div>
      
      <div class="feature-item">
        <div class="feature-icon">🤖</div>
        <div class="feature-content">
          <h3>AI 자동 변환</h3>
          <p>OpenAI 기반으로 감정적 표현을 자연스러운 비즈니스 톤으로 변환</p>
        </div>
      </div>
      
      <div class="feature-item">
        <div class="feature-icon">🌐</div>
        <div class="feature-content">
          <h3>도메인별 설정</h3>
          <p>사이트별로 기능 활성화/비활성화 및 일시중지 가능</p>
        </div>
      </div>
      
      <div class="feature-item">
        <div class="feature-icon">⚙️</div>
        <div class="feature-content">
          <h3>모드 선택</h3>
          <p>경고 모드(권장) 또는 자동변환 모드 중 선택 가능</p>
        </div>
      </div>
      
      <div class="feature-item">
        <div class="feature-icon">🔍</div>
        <div class="feature-content">
          <h3>592+ 욕설 DB</h3>
          <p>한국어 욕설 및 공격적 표현을 카테고리별로 정밀 분류하여 감지</p>
        </div>
      </div>
    </div>
    
    <div class="features-shortcuts">
      <h3>🎯 바로가기 키</h3>
      <div class="shortcut-grid">
        <div class="shortcut-item">
          <kbd>Ctrl/Cmd + Shift + Y</kbd>
          <span>선택된 텍스트 즉시 변환</span>
        </div>
        <div class="shortcut-item">
          <kbd>Enter</kbd>
          <span>메시지 전송 시 자동 검증</span>
        </div>
      </div>
    </div>
  </div>
  
  <!-- API Key 안내 배너 -->
  <div class="card banner" id="apiKeyBanner">
    <div class="banner-content">
      <div class="banner-icon">🔑</div>
      <div class="banner-text">
        <h3 class="banner-title">OpenAI API Key 설정 가이드</h3>
        <p class="banner-desc">
          BizTone을 사용하려면 OpenAI API Key가 필요합니다. 아래 단계를 따라 키를 발급받고 설정해주세요.
        </p>
        <div class="banner-tips">
          💡 <strong>팁:</strong> API 키는 "sk-"로 시작하며, 사용한 만큼만 과금됩니다. 조직에서 사용시 프록시 서버 경유를 권장합니다.
        </div>
        <div class="banner-buttons">
          <button type="button" class="btn-primary" id="openDashboard">
            🌐 OpenAI 대시보드 열기
          </button>
          <button type="button" class="btn-secondary" id="openGuide">
            📖 키 발급 가이드
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 피드백 배너 -->
  <div class="card banner" id="feedbackBanner" style="background: linear-gradient(135deg, #f0fdf4, #dcfce7); border: 1px solid #16a34a;">
    <div class="banner-content">
      <div class="banner-icon">💬</div>
      <div class="banner-text">
        <h3 class="banner-title" style="color: #15803d;">피드백 및 문제 신고</h3>
        <p class="banner-desc" style="color: #166534;">
          BizTone 사용 중 문제가 발생했거나 개선 아이디어가 있으시나요? 여러분의 소중한 피드백을 기다립니다.
        </p>
        <div class="banner-tips" style="color: #14532d; background: rgba(255,255,255,0.7);">
          🔍 <strong>신고 가능한 내용:</strong> 오탐/누락 감지, 변환 품질 문제, UI 버그, 기능 요청 등
        </div>
        <div class="banner-buttons">
          <button type="button" class="btn-tertiary" id="sendFeedback">
            📧 피드백 보내기
          </button>
          <button type="button" class="btn-secondary" id="viewLogs" style="background: #16a34a; color: white; border-color: #16a34a;">
            📋 로그 확인
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="card">
    <label for="apiKey">OpenAI API Key</label>
    <input id="apiKey" type="password" placeholder="sk-..." autocomplete="off" />
    <div class="muted">키는 로컬 동기화 저장소(chrome.storage.sync)에 암호화 없이 저장됩니다. 보안에 유의하세요.</div>

    <div class="row">
      <div style="flex:1">
        <label for="model">Model</label>
        <select id="model">
          <option value="gpt-4o-mini" selected>gpt-4o-mini</option>
          <option value="gpt-4o">gpt-4o</option>
          <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
        </select>
      </div>
      <div style="flex:1">
        <label>&nbsp;</label>
        <button id="save">저장</button>
        <button id="validate">검증</button>
      </div>
    </div>
  </div>

  <div id="status" class="muted" style="margin-top:10px;"></div>

  <!-- 가드 모드 설정 섹션 -->
  <div class="card" style="margin-top: 20px;">
    <h3>욕설 감지 모드</h3>
    <p class="muted">감정적인 표현이나 욕설이 감지되었을 때의 동작 방식을 선택하세요.</p>
    
    <div style="margin: 15px 0;">
      <label for="guardMode">감지 시 동작</label>
      <select id="guardMode">
        <option value="warn" selected>경고 모드 - 알림 후 사용자 선택 (권장)</option>
        <option value="convert">자동변환 모드 - 즉시 비즈니스 문장으로 변환</option>
      </select>
      <div class="muted" style="margin-top: 6px;">
        • <strong>자동변환:</strong> 감지 즉시 변환하여 교체 (기존 방식)<br>
        • <strong>경고:</strong> 알림만 표시하고 다시 Enter 시 원문 그대로 전송
      </div>
    </div>
    
    <div style="margin-top: 15px; text-align: right;">
      <button id="saveGuardMode">저장</button>
    </div>
  </div>

  <!-- 도메인 관리 섹션 -->
  <div class="card" style="margin-top: 20px;">
    <h3>도메인별 설정</h3>
    <p class="muted">특정 사이트에서 BizTone을 비활성화하거나 일시중지할 수 있습니다.</p>
    
    <div style="margin: 15px 0;">
      <label for="domainInput">도메인 추가</label>
      <div class="row">
        <input id="domainInput" type="text" placeholder="예: slack.com" style="flex: 1;" />
        <button id="addDomain">추가</button>
      </div>
    </div>
    
    <div id="domainList">
      <!-- 도메인 목록이 여기에 동적 생성됩니다 -->
    </div>
  </div>

  <!-- 화이트리스트 관리 섹션 -->
  <div class="card" style="margin-top: 20px;">
    <h3>허용 표현 (화이트리스트)</h3>
    <p class="muted">화이트리스트에 등록된 표현은 욕설로 감지되지 않습니다. 예: "시발점", "개발자"</p>
    
    <div style="margin: 15px 0;">
      <div class="row" style="align-items: end;">
        <div style="flex: 2;">
          <label for="whitelistText">허용할 표현</label>
          <input id="whitelistText" type="text" placeholder="예: 시발점에서 만나요" />
        </div>
        <div style="flex: 1;">
          <label for="whitelistMatch">매칭 방식</label>
          <select id="whitelistMatch">
            <option value="exact">정확히 일치</option>
            <option value="contains" selected>포함</option>
            <option value="regex">정규식</option>
          </select>
        </div>
        <div style="flex: 1;">
          <label for="whitelistLocale">언어</label>
          <select id="whitelistLocale">
            <option value="all" selected>모든 언어</option>
            <option value="ko">한국어</option>
            <option value="en">영어</option>
          </select>
        </div>
        <div style="flex: 0 0 auto;">
          <button id="addWhitelistItem">추가</button>
        </div>
      </div>
    </div>
    
    <div id="whitelistItems" style="margin-top: 15px;">
      <!-- 화이트리스트 아이템들이 여기에 동적 생성됩니다 -->
    </div>
    
    <div style="margin-top: 15px; text-align: right;">
      <button id="exportWhitelist" style="margin-right: 8px; background: #10b981; border-color: #10b981;">JSON 내보내기</button>
      <button id="importWhitelist">JSON 가져오기</button>
      <input type="file" id="whitelistFileInput" accept=".json" style="display: none;" />
    </div>
  </div>

  <!-- 블랙리스트 관리 섹션 -->
  <div class="card" style="margin-top: 20px;">
    <h3>금지 표현 (블랙리스트)</h3>
    <p class="muted">블랙리스트에 등록된 표현은 위험도 점수가 추가됩니다. 조직 내 금지 단어를 추가하세요.</p>
    
    <div style="margin: 15px 0;">
      <div class="row" style="align-items: end;">
        <div style="flex: 2;">
          <label for="blacklistText">금지할 표현</label>
          <input id="blacklistText" type="text" placeholder="예: 빨리 처리해" />
        </div>
        <div style="flex: 1;">
          <label for="blacklistMatch">매칭 방식</label>
          <select id="blacklistMatch">
            <option value="exact">정확히 일치</option>
            <option value="contains" selected>포함</option>
            <option value="regex">정규식</option>
          </select>
        </div>
        <div style="flex: 1;">
          <label for="blacklistWeight">위험도</label>
          <select id="blacklistWeight">
            <option value="1">낮음 (+1)</option>
            <option value="2" selected>보통 (+2)</option>
            <option value="3">높음 (+3)</option>
            <option value="4">매우높음 (+4)</option>
          </select>
        </div>
        <div style="flex: 1;">
          <label for="blacklistLocale">언어</label>
          <select id="blacklistLocale">
            <option value="all" selected>모든 언어</option>
            <option value="ko">한국어</option>
            <option value="en">영어</option>
          </select>
        </div>
        <div style="flex: 0 0 auto;">
          <button id="addBlacklistItem">추가</button>
        </div>
      </div>
    </div>
    
    <div id="blacklistItems" style="margin-top: 15px;">
      <!-- 블랙리스트 아이템들이 여기에 동적 생성됩니다 -->
    </div>
    
    <div style="margin-top: 15px; text-align: right;">
      <button id="exportBlacklist" style="margin-right: 8px; background: #10b981; border-color: #10b981;">JSON 내보내기</button>
      <button id="importBlacklist">JSON 가져오기</button>
      <input type="file" id="blacklistFileInput" accept=".json" style="display: none;" />
    </div>
  </div>

  <script src="options.js"></script>
</body>
</html>